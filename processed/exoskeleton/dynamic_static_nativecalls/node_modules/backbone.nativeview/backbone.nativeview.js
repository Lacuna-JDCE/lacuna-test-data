// Backbone.NativeView.js 0.3.2
// ---------------

//     (c) 2014 Adam Krebs, Jimmy Yuen Ho Wong
//     Backbone.NativeView may be freely distributed under the MIT license.
//     For all details and documentation:
//     https://github.com/akre54/Backbone.NativeView

(function (factory) {___jdce_logger("/node_modules/backbone.nativeview/backbone.nativeview.js", 0);
  if (typeof define === 'function' && define.amd) { define(['backbone'], factory);
  } else if (typeof exports === 'object') { factory(require('backbone'));
  } else { factory(Backbone); }
}(function (Backbone) {___jdce_logger("/node_modules/backbone.nativeview/backbone.nativeview.js", 1);
  // Cached regex to match an opening '<' of an HTML tag, possibly left-padded
  // with whitespace.
  var paddedLt = /^\s*</;

  // Caches a local reference to `Element.prototype` for faster access.
  var ElementProto = (typeof Element !== 'undefined' && Element.prototype) || {};

  // Cross-browser event listener shims
  var elementAddEventListener = ElementProto.addEventListener || function(){___jdce_logger("/node_modules/backbone.nativeview/backbone.nativeview.js", 2);}
  var elementRemoveEventListener = ElementProto.removeEventListener || function(){___jdce_logger("/node_modules/backbone.nativeview/backbone.nativeview.js", 3);}

  var indexOf = function(){___jdce_logger("/node_modules/backbone.nativeview/backbone.nativeview.js", 4);}

  // Find the right `Element#matches` for IE>=9 and modern browsers.
  var matchesSelector = ElementProto.matches ||
      ElementProto.webkitMatchesSelector ||
      ElementProto.mozMatchesSelector ||
      ElementProto.msMatchesSelector ||
      ElementProto.oMatchesSelector ||
      // Make our own `Element#matches` for IE8
      function(){___jdce_logger("/node_modules/backbone.nativeview/backbone.nativeview.js", 5);};

  // Cache Backbone.View for later access in constructor
  var BBView = Backbone.View;

  // To extend an existing view to use native methods, extend the View prototype
  // with the mixin: _.extend(MyView.prototype, Backbone.NativeViewMixin);
  Backbone.NativeViewMixin = {

    _domEvents: null,

    constructor: function() {___jdce_logger("/node_modules/backbone.nativeview/backbone.nativeview.js", 6);
      this._domEvents = [];
      return BBView.apply(this, arguments);
    },

    $: function(selector) {___jdce_logger("/node_modules/backbone.nativeview/backbone.nativeview.js", 7);
      return this.el.querySelectorAll(selector);
    },

    _removeElement: function() {___jdce_logger("/node_modules/backbone.nativeview/backbone.nativeview.js", 8);
      this.undelegateEvents();
      if (this.el.parentNode) this.el.parentNode.removeChild(this.el);
    },

    // Apply the `element` to the view. `element` can be a CSS selector,
    // a string of HTML, or an Element node.
    _setElement: function(element) {___jdce_logger("/node_modules/backbone.nativeview/backbone.nativeview.js", 9);
      if (typeof element == 'string') {
        if (paddedLt.test(element)) {
          var el = document.createElement('div');
          el.innerHTML = element;
          this.el = el.firstChild;
        } else {
          this.el = document.querySelector(element);
        }
      } else {
        this.el = element;
      }
    },

    // Set a hash of attributes to the view's `el`. We use the "prop" version
    // if available, falling back to `setAttribute` for the catch-all.
    _setAttributes: function(attrs) {___jdce_logger("/node_modules/backbone.nativeview/backbone.nativeview.js", 10);
      for (var attr in attrs) {
        attr in this.el ? this.el[attr] = attrs[attr] : this.el.setAttribute(attr, attrs[attr]);
      }
    },

    // Make a event delegation handler for the given `eventName` and `selector`
    // and attach it to `this.el`.
    // If selector is empty, the listener will be bound to `this.el`. If not, a
    // new handler that will recursively traverse up the event target's DOM
    // hierarchy looking for a node that matches the selector. If one is found,
    // the event's `delegateTarget` property is set to it and the return the
    // result of calling bound `listener` with the parameters given to the
    // handler.
    delegate: function(eventName, selector, listener) {___jdce_logger("/node_modules/backbone.nativeview/backbone.nativeview.js", 11);
      if (typeof selector === 'function') {
        listener = selector;
        selector = null;
      }

      var root = this.el;
      var handler = selector ? function(){___jdce_logger("/node_modules/backbone.nativeview/backbone.nativeview.js", 12);} : listener;

      elementAddEventListener.call(this.el, eventName, handler, false);
      this._domEvents.push({eventName: eventName, handler: handler, listener: listener, selector: selector});
      return handler;
    },

    // Remove a single delegated event. Either `eventName` or `selector` must
    // be included, `selector` and `listener` are optional.
    undelegate: function(){___jdce_logger("/node_modules/backbone.nativeview/backbone.nativeview.js", 13);},

    // Remove all events created with `delegate` from `el`
    undelegateEvents: function() {___jdce_logger("/node_modules/backbone.nativeview/backbone.nativeview.js", 14);
      if (this.el) {
        for (var i = 0, len = this._domEvents.length; i < len; i++) {
          var item = this._domEvents[i];
          elementRemoveEventListener.call(this.el, item.eventName, item.handler, false);
        };
        this._domEvents.length = 0;
      }
      return this;
    }
  };

  Backbone.NativeView = Backbone.View.extend(Backbone.NativeViewMixin);

  return Backbone.NativeView;
}));
